async function c(){try{typeof firebase>"u"&&await g();const e={apiKey:"{{ config('firebase.api_key') }}",authDomain:"{{ config('firebase.auth_domain') }}",projectId:"{{ config('firebase.project_id') }}",messagingSenderId:"{{ config('firebase.messaging_sender_id') }}",appId:"{{ config('firebase.app_id') }}"};firebase.apps.length||firebase.initializeApp(e);const i=firebase.messaging(),t=await navigator.serviceWorker.register("/firebase-messaging-sw.js");if(await Notification.requestPermission()==="granted"){const n="{{ env('FIREBASE_VAPID_KEY') }}".trim(),a=await i.getToken({vapidKey:n,serviceWorkerRegistration:t});localStorage.setItem("fcmToken",a),document.getElementById("fcmToken").value=a}return i.onMessage(n=>{console.log("Foreground message:",n),f(n)}),i}catch(e){throw console.error("Firebase initialization error:",e),e}}function g(){return new Promise(e=>{const i=document.createElement("script");i.src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js",i.onload=()=>{const t=document.createElement("script");t.src="https://www.gstatic.com/firebasejs/9.6.10/firebase-messaging-compat.js",t.onload=e,document.head.appendChild(t)},document.head.appendChild(i)})}function f(e){var i,t,s,n,a,o;if(Notification.permission==="granted"){const r=(i=e.data)!=null&&i.image?`${window.location.origin}/${e.data.image}`:"/img/placeholder-img.jfif";new Notification(((t=e.notification)==null?void 0:t.title)||((s=e.data)==null?void 0:s.heading)||"New Notification",{body:((n=e.notification)==null?void 0:n.body)||((a=e.data)==null?void 0:a.message),icon:r,data:{url:((o=e.data)==null?void 0:o.link)||"/"}})}}window.initializeFirebaseMessaging=c;
